create view one_six as
with agr_block as
(
	select distinct sum(t1.price) as transaction_amount, max(t1.price) as most_exp_article_id,
		   count(t1.price) as number_of_articles, t1.customer_id
	from transactions_train as t1
	right join customerid_date i1 using(customer_id)
	group by t1.customer_id
)

select * from id_date_age
right join agr_block using (customer_id)
