create view one_7 as
with date_group as 
(
	select 
		case 
		when part_date < DATE('2018-12-11') then 1
		when part_date >= DATE('2018-12-11') and part_date < DATE('2018-12-21') then 2
		else 3
	end as most_active_decade, part_date
	from customerid_date
	group by part_date
)

select * from one_6
left join date_group using(part_date)
